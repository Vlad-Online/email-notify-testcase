## Задание:

PHP Developer
Test Cases
Вы разрабатываете сервис для рассылки уведомлений об истекающих
подписках.
За один и за три дня до истечения срока подписки, нужно отправить
письмо пользователю с текстом "{username}, your subscription is expiring
soon".
Имеем следующее
1. Таблица в DB с пользователями (1 000 000+ строк):
username — имя
email — емейл
validts — unix ts до которого действует ежемесячная подписка
confirmed — 0 или 1 в зависимости от того, подтвердил ли
пользователь свой емейл по ссылке (пользователю после
регистрации приходит письмо с уникальный ссылкой на указанный
емейл, если он нажал на ссылку в емейле в этом поле
устанавливается 1)
checked — 0 или 1 (был ли проверен)
valid — 0 или 1 (является ли валидным)
2. Внешняя функция check_email( $email )
Проверяет емейл на валидность (на валидный емейл письмо точно
дойдёт) и возвращает 0 или 1. Функция работает от 1 секунды до 1
минуты. Вызов функции стоит 1 руб.
3.Функция send_email( $from, $to, $text )
Отсылает емейл. Функция работает от 1 секунды до 10 секунд.

Ограничения
1. Необходимо регулярно отправлять емейлы об истечении срока
подписки на те емейлы, на которые письмо точно дойдёт
2. Можно использовать cron
3. Можно создать необходимые таблицы в DB или изменить
   существующие
4. Для функций check_email и send_email нужно написать "заглушки"
5. По возможности не стоит использовать ООП
6. Код разместить в GitHub
7. Код может быть несовершенным и даже не 100% рабочим — нам
   важно понять образ вашего мышления и подходов к решению
   задачи

## Решение:
Сервис упакован в Docker контейнеры, а именно:

- **db** - база данных postgres 13
- **php-seed** - контейнер для генерации тестовых данных, при запуске добавит в базу 2 млн. случайных данных пользователей.
- **php-check** - сервис для проверки адресов email
- **php-notify** - сервис для рассылки уведомлений
  В структуру таблицы было добавлено дополнительное поле last_notify_at - unix ts когда было последний раз отправлено уведомление пользователю. Так же было добавлено 2 индекса для оптимизации запросов.

**Запуск:**

    docker compose up
